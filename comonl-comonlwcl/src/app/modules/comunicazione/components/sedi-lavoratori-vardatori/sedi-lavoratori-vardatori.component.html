<!--
SPDX-FileCopyrightText: Copyright 2019 - 2022 | CSI Piemonte
SPDX-License-Identifier: EUPL-1.2
-->
<em data-scroll-marker="sedi-lavoratori-vardatori"></em>
<div class="container">
    <h2><i style="color: #005ca9;" class="fas fa-edit mr-2"></i>{{"SEDI_LAVORATORI.TITLE" | translate}}</h2>
    <comonl-alert-message></comonl-alert-message>
        <div class="card">
            <div class="card-body">
                <form [formGroup]="form">
                    <h1 class="dati-anagrafici">{{"SEDI_LAVORATORI.SUBTITLE.SEDE_LAVORO" | translate}}</h1>
                    <!-- ************************* SEDE LAVORO ************************* -->
                    <div class="row">
                        <label *ngIf="!this.VIEW_MODE" class="form-group col-sm-8 col-md-7">I campi contrassegnati con <span *ngIf="!this.VIEW_MODE" class="asterisk">*</span> sono obbligatori</label>
                        <div class="form-group col-sm-8 col-md-7">
                        </div>
                        <div class="col-auto buttonCercaSedi">
                            <button type="button"
                              class="btn btn-outline-primary btn-lg"
                              *ngIf="!VIEW_MODE && !ANNULLO_MODE"
                              (click)="onClickCercaSedi()"
                              >{{ 'SEDI_LAVORATORI.BUTTON.RICERCA_SEDI' | translate | uppercase }}</button>
                          </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-8 col-md-3" formGroupName="comune">
                            <label class="field cod" for="comuneLeg">{{ "SEDI_LAVORATORI.FIELD.COD_COMUNE" | translate}}</label>
                            <div class="form-group">
                                <input type="text"
                                        class="form-control"
                                        formControlName="codComuneMin"
                                        oninput="this.value = this.value.toUpperCase().trim()"
                                        id="codComuneMin"
                                        minlength="4"
                                        maxlength="4">
                            </div>
                        </div>
                        <div class="form-group col-sm-8 col-md-6" formGroupName="comune">
                            <label class="field cod" for="comuneLeg">{{ "SEDI_LAVORATORI.FIELD.DS_COMUNE" | translate}}</label>
                            <div class="form-group">
                                <input type="text"
                                    class="form-control"
                                    formControlName="dsComTComune"
                                    oninput="this.value = this.value.toUpperCase().trim()"
                                    id="dsComTComune"
                                    minlength="50"
                                    maxlength="4">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-8 col-md-3" formGroupName="statiEsteri">
                            <label class="field cod" for="statoEsteroLeg">{{ "SEDI_LAVORATORI.FIELD.COD_STATI_EST" | translate}}</label>
                            <div class="form-group">
                                <input type="text"
                                    class="form-control"
                                    formControlName="codNazioneMin"
                                    oninput="this.value = this.value.toUpperCase().trim()"
                                    id="statoEsteroLeg"
                                    minlength="50"
                                    maxlength="4">
                            </div>
                        </div>
                        <div class="form-group col-sm-8 col-md-6" formGroupName="statiEsteri">
                            <label class="field cod" for="statoEsteroLeg">{{ "SEDI_LAVORATORI.FIELD.DS_STATI_EST" | translate}}</label>
                            <div class="form-group">
                                <input type="text"
                                    class="form-control"
                                    formControlName="dsStatiEsteri"
                                    oninput="this.value = this.value.toUpperCase().trim()"
                                    id="statoEsteroLeg"
                                    maxlength="50">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-8 col-md-7">
                            <label class="field cod" for="indirizzoLeg">{{ "SEDI_LAVORATORI.FIELD.INDIRIZZO" | translate}}</label>
                            <div class="form-group" >
                                <input type="text"
                                    class="form-control"
                                    formControlName="indirizzo"
                                    id="indirizzoLeg"
                                    maxlength="50">
                            </div>
                        </div>
                        <div class="form-group col-sm-8 col-md-2">
                            <label class="field cod" for="cap">{{ "SEDI_LAVORATORI.FIELD.CAP" | translate}}</label>
                            <div class="form-group" >
                                <input type="text"
                                    class="form-control"
                                    formControlName="codCap"
                                    id="cap"
                                    maxlength="5">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-8 col-md-3">
                            <label class="field cod" for="telefono">{{ "SEDI_LAVORATORI.FIELD.TELEFONO" | translate}}</label>
                            <div class="form-group" >
                                <input type="text"
                                    class="form-control"
                                    formControlName="telefono"
                                    id="telefono"
                                    maxlength="50">
                            </div>
                        </div>
                        <div class="form-group col-sm-8 col-md-2">
                            <label class="field cod" for="fax">{{ "SEDI_LAVORATORI.FIELD.FAX" | translate}}</label>
                            <div class="form-group" >
                                <input type="text"
                                    class="form-control"
                                    formControlName="fax"
                                    id="fax"
                                    maxlength="50">
                            </div>
                        </div>
                        <div class="form-group col-sm-8 col-md-4">
                            <label class="field cod" for="email">{{ "SEDI_LAVORATORI.FIELD.EMAIL" | translate}}</label>
                            <div class="form-group" >
                                <input type="email"
                                    class="form-control"
                                    formControlName="email"
                                    id="email"
                                    maxlength="50">
                            </div>
                        </div>
                        </div>
                    </form>
                    <form [formGroup]="formLav">
                    <!-- ************************* LAVORATORI ************************* -->
                    <h1 class="dati-anagrafici">{{"SEDI_LAVORATORI.SUBTITLE.LAVORATORI" | translate}}</h1>
                    <div class="row">
                        <div class="form-group col-sm-12 col-md-3">
                            <label for="codiceFiscale">{{ 'SEDI_LAVORATORI.FIELD.CF_LAVORATORE' | translate}} <span *ngIf="!this.VIEW_MODE" class="asterisk">*</span></label>
                            <div class="form-group">
                                <input type="text"
                                        class="form-control"
                                        formControlName="codiceFiscale"
                                        oninput="this.value = this.value.toUpperCase().trim()"
                                        id="codiceFiscale"
                                        maxlength="16"
                                        minlength="11">
                                    <div *ngIf="fL?.codiceFiscale?.errors" class="text-danger">
                                    <div *ngIf="fL?.codiceFiscale?.errors?.minlength || fL?.codiceFiscale?.errors?.pattern">{{"ERROR.FIELD.FISCAL_CODE.INVALID" | translate}}</div>
                                </div>
                            </div>
                        </div>
                        <!-- !this.VIEW_MODE &&  -->
                        <div *ngIf="!VIEW_MODE && !ANNULLO_MODE" class="col-auto">
                            <button type="button"
                            *ngIf="flgVisualizzaLav !== true; else nuovo"
                            (click)="onClickFindLavoratore(fL?.codiceFiscale.value)"
                            class="btn btn-primary ml-auto btn-lg btnSearch"
                            >{{ 'SEDI_LAVORATORI.BUTTON.RICERCA_LAVORATORE' | translate }}</button>
                        </div>
                        <div *ngIf="!VIEW_MODE && !ANNULLO_MODE && showNuovoLavBtn" class="col-auto">
                            <button type="button"
                            (click)="onClickOpenModalInserisciLavoratore()"
                            class="btn btn-primary ml-auto btn-lg btnSearch"
                            >{{ 'APP.INSERT' | translate | uppercase}}</button>
                        </div>
                        <div *ngIf="!VIEW_MODE && !ANNULLO_MODE && showModificaLavBtn" class="col-auto">
                            <button type="button"
                            (click)="onClickOpenModalModificaLavoratore()"
                            class="btn btn-primary ml-auto btn-lg btnSearch"
                            >{{ 'APP.MODIFICA' | translate | uppercase}}</button>
                        </div>

                        <!-- *ngIf="!this.VIEW_MODE" -->
                        <ng-template  #nuovo class="col-auto">
                            <button type="button"
                            (click)="onClickSvuotaForm()"
                            class="btn btn-primary ml-auto btn-lg btnSearch"
                            >{{ 'SEDI_LAVORATORI.BUTTON.NEW_LAVORATORE' | translate }}</button>
                        </ng-template>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-8 col-md-5">
                          <label class="field" for="cognome">{{ "SEDI_LAVORATORI.FIELD.COGNOME" | translate}}</label>
                              <input type="text"
                                  class="form-control"
                                  formControlName="cognome"
                                  id="cognome"
                                  maxlength="50">
                        </div>
                        <div class="form-group col-sm-8 col-md-4">
                            <label class="field" for="nome">{{ "SEDI_LAVORATORI.FIELD.NOME" | translate}}</label>
                                <input type="text"
                                    class="form-control"
                                    formControlName="nome"
                                    id="nome"
                                    maxlength="50">
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-8 col-md-3" >
                            <label class="field cod" for="codComuneMin">{{ "SEDI_LAVORATORI.FIELD.COD_COMUNE_DOMICILIO" | translate}}</label>
                            <div class="form-group" formGroupName="comuneDom">
                                <input type="text"
                                        class="form-control"
                                        formControlName="codComuneMin"
                                        id="codComuneMin"
                                        maxlength="50">
                            </div>
                        </div>
                        <div class="form-group col-sm-8 col-md-6" >
                            <label class="field cod" for="dsComTComune">{{ "SEDI_LAVORATORI.FIELD.DS_COMUNE_DOMICILIO" | translate}}</label>
                            <div class="form-group" formGroupName="comuneDom">
                                <input type="text"
                                    class="form-control"
                                    formControlName="dsComTComune"
                                    id="dsComTComune"
                                    maxlength="50">
                            </div>
                        </div>
                    </div>
                    </form>
                    <form [formGroup]="formDatiRapp">
                    <!-- **************** DATI RAPPORTO **************** -->
                    <h1 class="dati-title">{{"SEDI_LAVORATORI.SUBTITLE.DATI_RAPPORTO" | translate}}</h1>
                    <div class="row">
                        <div class="form-group col-sm-12 col-md-3">
                            <label class="field" for="dataInizioRapporto">{{ "SEDI_LAVORATORI.FIELD.DATA_INIZIO_RAPPORTO" | translate}} <span *ngIf="!this.VIEW_MODE" class="asterisk">*</span></label>
                            <div class="input-group">
                                <input 
                                formControlName="dtInizioRapporto"
                                type="text"
                                class="form-control"
                                id="dataInizioRapporto"
                                maxlength="10"
                                ngbDatepicker
                                #dataInizioRapporto="ngbDatepicker">
                                <div class="input-group-append">
                                <button
                                    class="btn btn-outline-primary calendar"
                                    (click)="dataInizioRapporto.toggle()"
                                    [disabled]="VIEW_MODE || ANNULLO_MODE"
                                    type="button">
                                    <span class="sr-only">{{"APP.DATE_PICKER.APRI_CALENADRIO" | translate}}</span><i class="far fa-calendar-alt fa-lg"></i></button>
                                </div>
                            </div>
                            <div *ngIf="fDR?.dtInizioRapporto?.invalid && fDR?.dtInizioRapporto?.value?.length > 0" class="text-danger">
                                {{'ERROR.INVALID_DATE' | translate}}
                            </div>
                        </div>
                        <div class="form-group col-sm-12 col-md-6">
                            <label class="field" for="tipoRapporto">{{ 'SEDI_LAVORATORI.FIELD.TIPO_RAPPORTO' | translate}}<span *ngIf="!this.VIEW_MODE" class="asterisk">*</span></label>
                            <div class="form-group">
                                <select
                                class="form-select"
                                formControlName="tipoContratti"
                                (change)="setStateFormControlsDipendentidaTipoContratto(true)"
                                id="tipoRapporto">
                                    <option [ngValue]="null"></option>
                                    <option *ngFor="let tipoRapp of listaTipoRapporto" [ngValue]="tipoRapp">{{tipoRapp?.dsComTTipoContratto}}</option>
                                </select>
                            </div>
                            <!-- <div class="form-group">
                                <input disabled type="text"class="form-control" [value]="tipoContrattiPerView" id="tipoRapporto">
                                <input hidden formControlName="tipoContratti">
                            </div> -->
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-12 col-md-3">
                            <label class="field" for="dataFineRapporto">{{ "SEDI_LAVORATORI.FIELD.DATA_FINE_RAPPORTO" | translate}}<span *ngIf="obbligoDtFineRapporto || RAPPORTO_DETERMINATO" class="asterisk">*</span></label>
                            <div class="input-group">
                                <input type="text"
                                class="form-control"
                                formControlName="dtFineRapporto"
                                id="dataFineRapporto"
                                maxlength="10"
                                ngbDatepicker
                                #dataFineRapporto="ngbDatepicker">
                                <div class="input-group-append">
                                <button
                                    class="btn btn-outline-primary calendar"
                                    (click)="dataFineRapporto.toggle()"
                                    [disabled]="VIEW_MODE || ANNULLO_MODE"
                                    type="button">
                                    <span class="sr-only">{{"APP.DATE_PICKER.APRI_CALENADRIO" | translate}}</span><i class="far fa-calendar-alt fa-lg"></i></button>
                                </div>
                            </div>
                            <div *ngIf="fDR?.dtFineRapporto?.invalid && fDR?.dtFineRapporto?.value?.length > 0" class="text-danger">
                                {{'ERROR.INVALID_DATE' | translate}}
                            </div>
                        </div>
                        <div class="form-group col-sm-12 col-md-3">
                            <label class="field" for="dataFinePeriodoFormativo">{{ "SEDI_LAVORATORI.FIELD.DATA_FINE_PERIODO_FORMATIVO" | translate}}<span *ngIf="!this.VIEW_MODE && (IS_APPRENDISTATO || IS_TIROCINIO)" class="asterisk">*</span></label>
                            <div class="input-group">
                                <input type="text"
                                class="form-control"
                                formControlName="dtFinePeriodoFormativo"
                                id="dataFinePeriodoFormativo"
                                maxlength="10"
                                ngbDatepicker
                                #dataFinePeriodoFormativo="ngbDatepicker">
                                <div class="input-group-append">
                                <button
                                    class="btn btn-outline-primary calendar"
                                    (click)="dataFinePeriodoFormativo.toggle()"
                                    [disabled]="VIEW_MODE || ANNULLO_MODE"
                                    type="button">
                                    <span class="sr-only">{{"APP.DATE_PICKER.APRI_CALENADRIO" | translate}}</span><i class="far fa-calendar-alt fa-lg"></i></button>
                                </div>
                            </div>
                            <div *ngIf="fDR?.dtFineRapporto?.invalid && fDR?.dtFineRapporto?.value?.length > 0" class="text-danger">
                                {{'ERROR.INVALID_DATE' | translate}}
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-12 col-md-3">
                            <label class="field" for="lavoroStagionale">{{ "SEDI_LAVORATORI.FIELD.LAVORO_STAGIONALE" | translate}}<span *ngIf="!this.VIEW_MODE" class="asterisk">*</span></label>
                            <div class="form-group ml-3">
                                <div class="row">
                                <div class="form-check form-check-inline">
                                    <input formControlName="flgLavStagionale" [value]="'S'" type="radio" id="Si">
                                    <label class="radio-button" for="Si">Si</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input formControlName="flgLavStagionale" [value]="'N'" type="radio" id="No">
                                    <label class="radio-button" for="No">No</label>
                                </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-8 col-md-4">
                            <label class="field cod" for="cfEntePromotore">{{ "SEDI_LAVORATORI.FIELD.CF_ENTE_PROMOTORE" | translate}}<span *ngIf="!this.VIEW_MODE && IS_TIROCINIO" class="asterisk">*</span></label>
                            <div class="form-group">
                                <input type="text"
                                        class="form-control"
                                        formControlName="cfSoggPromotoreTirocinio"
                                        id="cfEntePromotore"
                                        maxlength="16"
                                        minlength="11">
                            </div>
                        </div>
                    </div>
                        <!-- ************************* DATI INQUADRAMENTO ************************* -->
                        <h1 class="dati-title">{{"COMUNICAZIONE.DATI_INQUADRAMENTO" | translate}}</h1>
                        <div class="row">
                            <div class="form-group col-sm-8 col-md-3">
                                <label class="field" for="codCCNL">{{ "SEDI_LAVORATORI.FIELD.CODICE_CCNL" | translate}} <span *ngIf="!this.VIEW_MODE" class="asterisk">*</span></label>
                                <div class="form-group" formGroupName="ccnl">
                                    <input type="text"
                                            class="form-control"
                                            formControlName="codCcnlMin"
                                            id="codCCNL"
                                            maxlength="5">
                                        <div *ngIf="fDR?.ccnl?.controls?.codCcnlMin?.errors" class="text-danger">
                                            <div *ngIf="fDR?.ccnl?.controls?.codCcnlMin?.errors?.minlength">{{"ERROR.FIELD.MIN_LENGHT_2" | translate}}</div>
                                        </div>
                                </div>
                            </div>
                            <div class="form-group col-sm-8 col-md-6">
                                <label class="field" for="desCCNL">{{ "SEDI_LAVORATORI.FIELD.DESCRIZIONE_CCNL" | translate}} <span *ngIf="!this.VIEW_MODE" class="asterisk">*</span></label>
                                <div class="form-group" formGroupName="ccnl">
                                    <input type="text"
                                            class="form-control"
                                            formControlName="dsCcnl"
                                            id="descrCCNL"
                                            maxlength="500">
                                            <div *ngIf="fDR?.ccnl?.controls?.dsCcnl?.errors" class="text-danger">
                                                <div *ngIf="fDR?.ccnl?.controls?.dsCcnl?.errors?.minlength">{{"ERROR.FIELD.MIN_LENGHT_3" | translate}}</div>
                                            </div>
                                </div>
                            </div>
                            <!-- [disabled]="!(f?.ccnl?.controls?.codCcnlMin?.value?.length > 1 || f?.ccnl?.controls?.dsCcnl?.value?.length > 2)" -->
                            <div class="form-group col">
                                <button 
                                id="btnSearchCCNL" 
                                (click)="onClickfindCcnl()"
                                *ngIf="!VIEW_MODE && !ANNULLO_MODE"
                                type="button" 
                                class="btn btn-outline-primary btn-sm search">
                                    {{ 'COMUNICAZIONE.DETTAGLIO.BUTTON.SEARCH' | translate | uppercase}}</button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group col-sm-8 col-md-3">
                                <label class="field" for="retrib">{{ "SEDI_LAVORATORI.FIELD.RETRIBUZIONE_LORDA_ANNUALE" | translate}} <span *ngIf="!this.VIEW_MODE" class="asterisk">*</span></label>
                                <div class="form-group">
                                    <input type="text"
                                            class="form-control"
                                            formControlName="retribuzioneCompenso"
                                            comonlDigitOnly
                                            id="retrib"
                                            maxlength="9">
                                </div>
                            </div>
                            <div class="form-group col-sm-8 col-md-6">
                                <label class="field" for="descrInquadramento">{{ "SEDI_LAVORATORI.FIELD.DESCRIZIONE_INQUADRAMENTO" | translate}} <span *ngIf="!this.VIEW_MODE" class="asterisk">*</span></label>
                                <div class="form-group">
                                    <input type="text"
                                            class="form-control"
                                            formControlName="livelloInquadramento"
                                            id="descrInquadramento"
                                            maxlength="6">
                                </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-8 col-md-3">
                            <label class="field cod" for="codISTAT">{{ "SEDI_LAVORATORI.FIELD.CODICE_ISTAT" | translate}} </label>
                            <div class="form-group" formGroupName="istatLivello5">
                                <input type="text"
                                        class="form-control"
                                        formControlName="codIstat2001livello5Min"
                                        id="codISTAT"
                                        maxlength="12">
                                    <div *ngIf="fDR?.istatLivello5?.controls?.codIstat2001livello5Min?.errors" class="text-danger">
                                        <div *ngIf="fDR?.istatLivello5?.controls?.codIstat2001livello5Min?.errors?.minlength">{{"ERROR.FIELD.MIN_LENGHT_3" | translate}}</div>
                                    </div>
                            </div>
                        </div>
                        <div class="form-group col-sm-8 col-md-6">
                            <label class="field" for="descrISTAT">{{ "SEDI_LAVORATORI.FIELD.DESCRIZIONE_ISTAT" | translate}} </label>
                            <div class="form-group" formGroupName="istatLivello5">
                                <input type="text"
                                        class="form-control"
                                        formControlName="dsComIstat2001livello5"
                                        id="descrISTAT"
                                        [disabled]="!(fDR?.istatLivello5?.controls?.codIstat2001livello5Min?.value?.length > 2 || fDR?.istatLivello5?.controls?.dsComIstat2001livello5?.value?.length > 2)"
                                        maxlength="300">
                                    <div *ngIf="fDR?.istatLivello5?.controls?.dsComIstat2001livello5?.errors" class="text-danger">
                                        <div *ngIf="fDR?.istatLivello5?.controls?.dsComIstat2001livello5?.errors?.minlength">{{"ERROR.FIELD.MIN_LENGHT_3" | translate}}</div>
                                    </div>
                            </div>
                        </div>
                        <!--   -->
                        <div class="form-group col">
                            <button 
                            id="btnSearchISTAT"
                            (click)="onClickFindIstat()"
                            *ngIf="!VIEW_MODE && !ANNULLO_MODE"
                            type="button" 
                            class="btn btn-outline-primary btn-sm search">
                                {{ 'COMUNICAZIONE.DETTAGLIO.BUTTON.SEARCH' | translate | uppercase}}</button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-8 col-md-3">
                            <label class="field" for="patINAIL">{{ "SEDI_LAVORATORI.FIELD.PAT_INAIL" | translate}} </label>
                            <div class="form-group">
                                <input type="text"
                                class="form-control"
                                formControlName="patInail"
                                id="patINAIL"
                                comonlDigitOnly
                                minlength="8"
                                maxlength="10">
                                <div *ngIf="fDR?.patInail?.errors" class="text-danger">
                                        <div *ngIf="fDR?.patInail?.errors?.minlength">{{"ERROR.FIELD.MIN_LENGHT_NUMBER_8" | translate}}</div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group col-sm-12 col-md-3">
                            <label class="field" for="assObbl">{{ "SEDI_LAVORATORI.FIELD.ASSUNZIONE_OBBLIGATORIA" | translate}}<span *ngIf="!this.VIEW_MODE" class="asterisk">*</span></label>
                            <div class="form-group ml-3">
                                <div class="row">
                                    <div class="form-check form-check-inline">
                                        <input (change)="setControlStateAltriDati()" formControlName="flgAssunzioneObbligatoria" [value]="'S'" type="radio" id="Si">
                                        <label class="radio-button" for="Si">Si</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input (change)="setControlStateAltriDati()" formControlName="flgAssunzioneObbligatoria" [value]="'N'" type="radio" id="No">
                                        <label class="radio-button" for="No">No</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-12 col-md-6">
                            <label class="field" for="entePrev">{{ 'SEDI_LAVORATORI.FIELD.ENTE_PREVIDENZIALE' | translate}} <span *ngIf="!this.VIEW_MODE" class="asterisk">*</span></label>
                            <div class="form-group">
                                <select
                                class="form-select"
                                formControlName="entePrevidenziale"
                                id="entePrev">
                                    <option [ngValue]="null"></option>
                                    <option *ngFor="let entePrev of listaEntiPrevidenziali" [ngValue]="entePrev">{{entePrev?.dsComTEntePrevidenziale}}</option>
                                </select>
                            </div>
                            <!-- <div class="form-group">
                                <input disabled type="text"class="form-control" [value]="entePrevidenzialePerView" id="entePrev">
                                <input hidden formControlName="entePrevidenziale">
                            </div> -->
                        </div>
                        <div class="form-group col-sm-8 col-md-3">
                            <label class="field cod" for="codEntePrev">{{ "SEDI_LAVORATORI.FIELD.COD_ENTE_PREVIDENZIALE" | translate}}</label>
                        <div class="form-group">
                            <input type="text"
                                    class="form-control"
                                    formControlName="codiceEntePrev"
                                    id="codEntePrev"
                                    maxlength="20">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-12 col-md-4">
                            <label class="field" for="tipoOrario">{{ 'SEDI_LAVORATORI.FIELD.TIPO_ORARIO' | translate}} </label>
                            <div class="form-group">
                                <select
                                class="form-select"
                                formControlName="tipoOrario"
                                (change)="setControlStatenumOreSettMed()"
                                id="tipoOrario">
                                    <option [ngValue]="null"></option>
                                    <option *ngFor="let tipoOrario of listaTipoOrario" [ngValue]="tipoOrario">{{tipoOrario?.dsComTTipoOrario}}</option>
                                </select>
                            </div>
                            <!-- <div class="form-group">
                                <input disabled type="text"class="form-control" [value]="tipoOrarioPerView" id="tipoOrario">
                                <input hidden formControlName="tipoOrario">
                            </div> -->
                        </div>
                        <div class="form-group col-sm-8 col-md-2">
                            <label class="field cod" for="oreSettimanaliMedie">{{ "SEDI_LAVORATORI.FIELD.ORE_SETTIMANALI_MEDIE" | translate}} </label>
                            <div class="form-group">
                                <input type="text"
                                    class="form-control"
                                    formControlName="numOreSettMed"
                                    id="oreSettimanaliMedie"
                                    comonlDigitOnly
                                    maxlength="2">
                                </div>
                        </div>
                    </div>
    
                    <!-- ************************* ALTRI DATI UNILAV ************************* -->
                    <h1 class="dati-title">{{"SEDI_LAVORATORI.SUBTITLE.ALTRI" | translate}}</h1>
                    <div class="row">
                        <div class="form-group col-sm-12 col-md-4">
                            <label class="field" for="categoriaLav">{{ 'SEDI_LAVORATORI.FIELD.CATEGORIA_LAVORATORE' | translate}} <span *ngIf="obbligocategLavAssObbl" class="asterisk">*</span></label>
                        </div>
                        <div class="form-group col-sm-12 col-md-5">
                            <select (change)="setControlStateLegge68Tipo()"
                            class="form-select"
                            formControlName="categLavAssObbl"
                            id="categoriaLav">
                                <option [ngValue]="null"></option>
                                <option *ngFor="let categLavAssObbl of listaCategLavAssObbl" [ngValue]="categLavAssObbl">{{categLavAssObbl?.dsComTCategLavAssObbl}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-12 col-md-4">
                            <label class="field" for="legge68tipo">{{ 'SEDI_LAVORATORI.FIELD.LEGGE68_TIPO' | translate}}<span *ngIf="obbligatorietaTriplaL68" class="asterisk">*</span></label>
                        </div>
                        <div class="form-group col-sm-12 col-md-5">
                            <select
                            class="form-select"
                            (change)="setbligatrietaTriplaL68()"
                            formControlName="tipoAttoL68"
                            id="legge68tipo">
                                <option [ngValue]="null"></option>
                                <option *ngFor="let tipoAttoL68 of listaTipoAttoL68" [ngValue]="tipoAttoL68">{{tipoAttoL68.dsComTTipoAttoL68}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-12 col-md-4">
                            <label class="field" for="legge68data">{{ 'SEDI_LAVORATORI.FIELD.LEGGE68_DATA' | translate}}<span *ngIf="obbligatorietaTriplaL68" class="asterisk">*</span></label>
                            <div>
                                <div class="form-group">
                                    <div class="input-group">
                                        <input type="text"
                                        class="form-control"
                                        formControlName="dtLegge68"
                                        id="legge68data"
                                        (dateSelect)="setbligatrietaTriplaL68()"
                                        (change)="setbligatrietaTriplaL68()"
                                        ngbDatepicker
                                        #legge68data="ngbDatepicker"
                                        maxlength="10">
                                        <div class="input-group-append">
                                            <button
                                            class="btn btn-outline-primary calendar"
                                            (click)="legge68data.toggle()"
                                            [disabled]="VIEW_MODE || ANNULLO_MODE"
                                            type="button">
                                            <span class="sr-only">{{"APP.DATE_PICKER.APRI_CALENADRIO" | translate}}</span><i class="far fa-calendar-alt fa-lg"></i></button>
                                        </div>
                                    </div>
                                    <div *ngIf="fDR?.dtLegge68?.invalid && fDR?.dtLegge68?.value?.length > 0" class="text-danger">
                                        {{'ERROR.INVALID_DATE' | translate}}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group col-sm-8 col-md-5">
                            <label class="field" for="legge68num">{{ "SEDI_LAVORATORI.FIELD.LEGGE68_NUM" | translate}}<span *ngIf="obbligatorietaTriplaL68" class="asterisk">*</span></label>
                            <div class="form-group">
                                <input type="text"
                                class="form-control"
                                formControlName="numeroAttoLegge68"
                                (change)="setbligatrietaTriplaL68()"
                                id="legge68num"
                                comonlDigitOnly
                                maxlength="10">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-12 col-md-4">
                            <label class="field" for="socio">{{ "SEDI_LAVORATORI.FIELD.SOCIO_LAVORATORE" | translate}} <span *ngIf="!this.VIEW_MODE" class="asterisk">*</span> </label>
                            <div class="form-group ml-3">
                                <div class="row">
                                <div class="form-check form-check-inline">
                                    <input formControlName="flgSocioLavoratore" [value]="'S'" type="radio" id="Si">
                                    <label class="radio-button" for="Si">Si</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input formControlName="flgSocioLavoratore" type="radio" [value]="'N'" id="No">
                                    <label class="radio-button" for="No">No</label>
                                </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group col-sm-12 col-md-4">
                            <label class="field" for="agricoltura">{{ "SEDI_LAVORATORI.FIELD.LAVORO_AGRICOLTURA" | translate}}<span *ngIf="!this.VIEW_MODE" class="asterisk">*</span></label>
                            <div class="form-group ml-3">
                                <div class="row">
                                <div class="form-check form-check-inline">
                                    <input (change)="setGiornateLavPrev()" formControlName="flgLavoroAgricoltura" [value]="'S'" type="radio" id="Si">
                                    <label class="radio-button" for="Si">Si</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input (change)="setGiornateLavPrev()" formControlName="flgLavoroAgricoltura" [value]="'N'" type="radio" id="No">
                                    <label class="radio-button" for="No">No</label>
                                </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-8 col-md-4">
                            <label class="field" for="giornateLav">{{ "SEDI_LAVORATORI.FIELD.GIORNATE_LAVORATIVE" | translate}}</label>
                            <div class="form-group">
                                <input type="text"
                                class="form-control"
                                formControlName="giornateLavPreviste"
                                id="giornateLav"
                                comonlDigitOnly
                                maxlength="4">
                            </div>
                        </div>
                        <div class="form-group col-sm-8 col-md-5">
                            <label class="field" for="tipoLav">{{ "SEDI_LAVORATORI.FIELD.TIPO_LAVORAZIONE" | translate}}</label>
                            <div class="form-group">
                                <input type="text"
                                class="form-control"
                                    formControlName="tipoLavorazione"
                                    id="tipoLav"
                                    maxlength="100">
                                </div>
                            </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-12 col-md-3">
                            <label class="field" for="lavMob">{{ "SEDI_LAVORATORI.FIELD.LAVORATORE_MOBILITA" | translate}} <span *ngIf="!this.VIEW_MODE" class="asterisk">*</span></label>
                            <div class="form-group">
                                <div class="form-check form-check-inline">
                                    <input formControlName="flgLavInMobilita" [value]="'S'" type="radio" id="Si">
                                    <label class="radio-button" for="Si">Si</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input formControlName="flgLavInMobilita" [value]="'N'" type="radio" id="No">
                                    <label class="radio-button" for="No">No</label>
                                </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div *ngIf="!VIEW_MODE" class="col-auto ml-auto buttonCercaSedi">
                        <button type="button"
                          [disabled]="SEDE_LAVORO_INVALID || !formLav?.valid || !formDatiRapp?.valid"
                          class="btn btn-outline-primary btn-lg"
                          *ngIf="!VIEW_MODE && !ANNULLO_MODE"
                          (click)="aggiungiLavoratore()"
                          >{{ 'SEDI_LAVORATORI.BUTTON.AGGIUNGI_LAVORATORE' | translate }}</button>
                      </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <comonl-paginated-array-table [columnNumber]="7" [pagedResponse]="this.elencoLavoratori" [limit]="8">
                            <ng-template comonlPaginationHead>
                                <tr>
                                <th scope="col">Sede (indirizzo)</th>
                                <th scope="col">Codice fiscale</th>
                                <th scope="col">Cognome</th>
                                <th scope="col">Nome</th>
                                <th scope="col">Data inizio</th>
                                <th scope="col">Tipo rapporto</th>
                                <th scope="col">Azioni</th>
                                </tr>
                            </ng-template>
                            <ng-template comonlPaginationBody let-lavoratore>
                                <tr>
                                    <td>{{lavoratore?.sedeLavoroVD?.comune?.dsComTComune}} ({{lavoratore?.sedeLavoroVD?.indirizzo}})</td>
                                    <td>{{lavoratore?.lavoratoreVD?.codiceFiscale}}</td>
                                    <td>{{lavoratore?.lavoratoreVD?.cognome}}</td>
                                    <td>{{lavoratore?.lavoratoreVD?.nome}}</td>
                                    <td>{{lavoratore?.rapportoVD?.dtInizioRapporto | date: 'dd/MM/yyyy'}}</td>
                                    <td>{{lavoratore?.rapportoVD?.tipoContratti?.dsComTTipoContratto}}</td>
                                    <td><a><i *ngIf="this.elencoLavoratori.length > 0" class="fas fa-eye mr-2" (click)="caricaDatiLavoratore(lavoratore, 'visualizza')"></i></a>
                                        <a><i *ngIf="(!VIEW_MODE && !ANNULLO_MODE) && this.elencoLavoratori?.length > 0" class="fas fa-trash-alt mr-2" (click)="eliminaLavoratore(lavoratore)"></i></a>
                                    </td>
                                </tr>
                            </ng-template>
                        </comonl-paginated-array-table>
                        <div>
                            <div *ngIf="(!this.INS_MODE && !this.comunicazioneToSave?.rapLavSedeVD) || (!this.INS_MODE && !this.elencoLavoratori && this.elencoLavoratori?.length <= 0)" class="alert alert-warning" role="alert">
                                {{ 'ERROR.ERROR_TITLE' | translate}}
                            </div>
                        </div>
                        </div>
                    </div>
            </form>
            <div class="row">
                    <div class="col-auto" *ngIf="!VIEW_MODE">
                        <button type="button" class="btn btn-outline-secondary btn-sm"
                        (click)="onClickAnnulla()"
                        >{{ 'APP.ANNULLA' | translate | uppercase}}</button>
                      </div>
                      <!-- <div class="col-auto ml-auto">
                        <button type="button"
                          class="btn btn-primary ml-auto btn-lg"
                          (click)="findInvalidControls()"
                          >{{ 'SEDI_LAVORATORI.BUTTON.FIND' | translate }}</button>
                      </div> -->
                    <div class="col-auto ml-auto">
                      <button type="button"
                        *ngIf="!VIEW_MODE"
                        class="btn btn-primary ml-auto btn-lg"
                        (click)="onSubmit()"
                        [disabled]="!elencoLavoratori || (elencoLavoratori && elencoLavoratori.length < 1)"
                        >{{ 'SEDI_LAVORATORI.BUTTON.CONFIRM_SEDE_E_LAVORATORE' | translate }}</button>
                        <!-- TODO: DA SOSTITUIRE -->
                        <!-- [disabled]="fieldsForm || fieldsLav || !formDatiRapp.valid" -->
                    </div>
                </div>
            </div>
        </div>
    </div>